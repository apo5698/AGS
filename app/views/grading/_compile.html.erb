<div class="row mb-4">
  <div class="col-lg-8">
    <h3>Source Files</h3>
    <% source_files = FileHelper.tree(@upload_root.join('submissions'), depth: 2, type: '.java')[0] %>
    <% if source_files.nil? %>
      None
    <% else %>
      <% source_files.except!('/') %>
      <%= form_for :compile do |f| %>
        <div class="tab-content form-group">
          <% source_files.sort.each do |k, v| %>
            <div class="tab-pane fade" id="<%= k.tr('/', '').tr(' ', '_') %>" role="tabpanel">
              <ul class="list-group code">
                <% v.each do |file| %>
                  <li class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                    <div class="mr-auto">
                      <span data-toggle="tooltip" data-placement="right"
                            title="<%= UploadHelper.fileinfo(File.join(@upload_root, 'submissions', file)) %>">
                        <%= File.basename(file) %>
                      </span>
                    </div>
                    <% if GradingHelper.is_compiled?(File.join(@upload_root, 'submissions', file)) %>
                      <% badge = ['badge badge-pill badge-success', 'Compiled', 'fas fa-check'] %>
                    <% else %>
                      <% badge = ['badge badge-pill badge-danger', 'Not yet compiled', 'fas fa-question'] %>
                    <% end %>
                    <span class="<%= badge[0] %>" data-toggle="tooltip" data-placement="right" title="<%= badge[1] %>">
                      <i class="<%= badge[2] %>"></i>
                    </span>
                    <div class="custom-control custom-checkbox ml-3">
                      <%= f.check_box :"#{file}", class: 'custom-control-input' %>
                      <%= f.label :"#{file}", 0.chr, class: "custom-control-label" %>
                    </div>
                  </li>
                <% end %>
              </ul>
            </div>
          <% end %>
        </div>
        <div class="form-group">
          <div class="custom-control custom-checkbox">
            <%= f.check_box :"options[junit]", class: 'custom-control-input' %>
            <%= f.label :"options[junit]", 'Run with Junit library (tests)', class: 'custom-control-label' %>
          </div>
        </div>
        <div class="form-group">
          <%= f.label :arg, 'Optional arguments (separated by space)', class: 'col-form-label' %>
          <%= f.text_field :arg, class: 'form-control', placeholder: 'Arguments' %>
        </div>
        <%= f.submit 'Compile all', class: "btn btn-primary" %>
      <% end %>
    <% end %>
  </div>
</div>
<div class="row mb-4">
  <div class="col-lg-12">
    <h3>Console Output</h3>
    <div class="terminal"><%= @console_output %></div>
  </div>
</div>